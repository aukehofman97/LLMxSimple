FUNCTION transformData(input):
    # Initialize the output structure with empty lists for Event, Location, and BusinessTransaction
    OUTPUT = {
        "Event": LIST,
        "Location": LIST,
        "BusinessTransaction": LIST
    }

    # Generate unique UUIDs for the main event, location, and business transaction entities
    main_event_uuid = STRING(generateUUID())
    location_uuid = STRING(generateUUID()) IF "place" in input["message"] ELSE null
    business_transaction_uuid = STRING(generateUUID()) IF "externalConsignmentId" in input["message"] ELSE null

    # Process Event
    MAIN_EVENT = {
        "Event_UUID": STRING(main_event_uuid),
        "Actual_Time": STRING(input["message"]["place"]["dateTimeType"]["dateTime"]) IF "place" in input["message"] ELSE null,
        "milestone": STRING(deriveMilestone(input["message"]["eventType"])), # Custom function to map event types to milestones
        "involvesLocation": STRING(location_uuid),
        "involvesBusinessTransaction": STRING(business_transaction_uuid) # Ensure it's always a STRING, not a LIST
    }
    OUTPUT["Event"].append(MAIN_EVENT)

    # Process Location if present in the input
    IF "place" in input["message"]:
        LOCATION = {
            "UUID": STRING(location_uuid),
            "function": STRING("Terminal"), # Example fixed function type; adjust based on input if needed
            "locationCode": STRING(input["message"]["place"]["placeLocalization"]["terminalNode"]["nodeCode"])
        }
        OUTPUT["Location"].append(LOCATION)

    # Process BusinessTransaction if present in the input
    IF "externalConsignmentId" in input["message"]:
        BUSINESS_TRANSACTION = {
            "UUID": STRING(business_transaction_uuid),
            "externalReference": STRING(input["message"]["externalConsignmentId"])
        }
        OUTPUT["BusinessTransaction"].append(BUSINESS_TRANSACTION)

    # Return the transformed output structure
    RETURN OUTPUT

# Utility Functions
FUNCTION generateUUID() -> STRING:
    RETURN "genid-" + randomString()  # Generate a unique identifier string

FUNCTION deriveMilestone(eventType) -> STRING:
    # Define mappings for different event types
    MILESTONE_MAPPINGS = {
        "ARRIVAL_EVENT": "start",
        "DEPARTURE_EVENT": "end"
        # Add additional mappings as necessary
    }
    RETURN MILESTONE_MAPPINGS.get(eventType, "unknown")